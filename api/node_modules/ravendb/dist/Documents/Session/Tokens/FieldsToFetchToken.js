"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const QueryToken_1 = require("./QueryToken");
const Exceptions_1 = require("../../../Exceptions");
class FieldsToFetchToken extends QueryToken_1.QueryToken {
    constructor(fieldsToFetch, projections, customFunction) {
        super();
        this.fieldsToFetch = fieldsToFetch;
        this.projections = projections;
        this.customFunction = customFunction;
    }
    static create(fieldsToFetch, projections, customFunction) {
        if (!fieldsToFetch || !fieldsToFetch.length) {
            Exceptions_1.throwError("InvalidArgumentException", "fieldToFetch cannot be null");
        }
        if (!customFunction && projections && projections.length !== fieldsToFetch.length) {
            Exceptions_1.throwError("InvalidArgumentException", "Length of projections must be the same as length of field to fetch");
        }
        return new FieldsToFetchToken(fieldsToFetch, projections, customFunction);
    }
    writeTo(writer) {
        for (let i = 0; i < this.fieldsToFetch.length; i++) {
            const fieldToFetch = this.fieldsToFetch[i];
            if (i > 0) {
                writer.append(", ");
            }
            this._writeField(writer, fieldToFetch);
            if (this.customFunction) {
                continue;
            }
            const projection = this.projections ? this.projections[i] : null;
            if (!projection || projection === fieldToFetch) {
                continue;
            }
            writer.append(" as ");
            writer.append(projection);
        }
    }
}
exports.FieldsToFetchToken = FieldsToFetchToken;
